---
import {
  getTranslation,
  languageMetadata,
  languages,
} from "@/i18n/translations";
import Icon from "@/components/Icon.astro";
import { mdiTranslate } from "@mdi/js";

interface Props {
  lang: string;
}

const { lang } = Astro.props;
const t = getTranslation(lang);

const currentPath = Astro.url.pathname;

const navItems = [
  { href: `/${lang}/publications`, label: t.publications },
  { href: `/${lang}/about`, label: t.about },
  { href: `/${lang}/contact`, label: t.contact },
];

const isHomeActive = currentPath === `/${lang}/` || currentPath === `/${lang}`;
---

<nav class="flex flex-wrap justify-between items-center gap-2 mb-4 max-w-4xl w-full mx-auto">
  <a
    href={`/${lang}/`}
    class={`hover:opacity-70 text-xl font-serif ${isHomeActive ? "border-b-4 border-accent" : ""}`}
  >
    {t.home}
  </a>
  <div class="flex items-center gap-1">
    <div class="flex gap-1">
      {
        navItems.map((item) => {
          const isActive = currentPath === item.href;
          return (
            <a
              href={item.href}
              class={`btn btn-ghost ${isActive ? "!border-b-4 !border-accent rounded-b-none" : ""}`}
            >
              {item.label}
            </a>
          );
        })
      }
    </div>
    <div class="dropdown dropdown-end">
      <label tabindex="0" class="btn btn-sm btn-circle btn-ghost">
        <Icon path={mdiTranslate} size={16} />
      </label>
      <ul
        tabindex="0"
        class="dropdown-content menu p-2 shadow bg-base-100 rounded-box w-52"
      >
        {
          languages.map((langCode) => {
            const metadata =
              languageMetadata[langCode as keyof typeof languageMetadata];
            return (
              <li>
                <a href={metadata.url}>{metadata.name}</a>
              </li>
            );
          })
        }
      </ul>
    </div>
  </div>
</nav>
